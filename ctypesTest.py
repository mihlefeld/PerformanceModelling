from ctypes import *
culib=CDLL("./build/libcuMppm.so")

class CPUMatrix(Structure):
    _fields_ = [('width', c_int), ('height', c_int), ('elements',POINTER(c_float))]

    def __repr__(self):
      repstring= "CPUMatrix\n width: "+str(self.width)+", height: "+str(self.height)
      return repstring

w=4
h=125
messurements=[ 20, 1, 100, 201.114, 
20, 2, 100, 882.001, 
20, 3, 100, 1921.29, 
20, 4, 100, 3363.26, 
20, 5, 100, 5187.69, 
30, 1, 100, 301.346, 
30, 2, 100, 1378.82, 
30, 3, 100, 2990.56, 
30, 4, 100, 5092.27, 
30, 5, 100, 7906.39, 
40, 1, 100, 400.162, 
40, 2, 100, 1919.4,
40, 3, 100, 4128.03, 
40, 4, 100, 7038.01, 
40, 5, 100, 10712,
50, 1, 100, 496.822, 
50, 2, 100, 2509.57, 
50, 3, 100, 5267.97, 
50, 4, 100, 8984.68, 
50, 5, 100, 13529, 
60, 1, 100, 606.18, 
60, 2, 100, 3134.49, 
60, 3, 100, 6594.74, 
60, 4, 100, 11014, 
60, 5, 100, 16737.9, 
20, 1, 200, 402.031, 
20, 2, 200, 1672.16, 
20, 3, 200, 3698.08, 
20, 4, 200, 6555.74, 
20, 5, 200, 10185.4, 
30, 1, 200, 607.017, 
30, 2, 200, 2580.25, 
30, 3, 200, 5695.32, 
30, 4, 200, 9944.27, 
30, 5, 200, 15373.7, 
40, 1, 200, 797.624, 
40, 2, 200, 3522.33, 
40, 3, 200, 7740.79, 
40, 4, 200, 13380.1, 
40, 5, 200, 20576.4, 
50, 1, 200, 1010.49, 
50, 2, 200, 4479.74, 
50, 3, 200, 9754.13, 
50, 4, 200, 17133.2, 
50, 5, 200, 26017, 
60, 1, 200, 1205.39, 
60, 2, 200, 5587.54, 
60, 3, 200, 11999.9, 
60, 4, 200, 20606.5, 
60, 5, 200, 31469.1, 
20, 1, 300, 603.306, 
20, 2, 300, 2471.78, 
20, 3, 300, 5548.08, 
20, 4, 300, 9785.85, 
20, 5, 300, 15222.8, 
30, 1, 300, 900.97, 
30, 2, 300, 3782.54, 
30, 3, 300, 8285.39, 
30, 4, 300, 14739.7, 
30, 5, 300, 22636.8, 
40, 1, 300, 1198.71, 
40, 2, 300, 5142.1, 
40, 3, 300, 11387.8, 
40, 4, 300, 19759, 
40, 5, 300, 30744.5, 
50, 1, 300, 1504.92, 
50, 2, 300, 6406.23, 
50, 3, 300, 14304.3, 
50, 4, 300, 24608.6, 
50, 5, 300, 38710, 
60, 1, 300, 1779.15, 
60, 2, 300, 7893.81, 
60, 3, 300, 17350.1, 
60, 4, 300, 30070.7, 
60, 5, 300, 47006.1, 
20, 1, 400, 803.209, 
20, 2, 400, 3319.43, 
20, 3, 400, 7370.23, 
20, 4, 400, 13040.8, 
20, 5, 400, 20225.4, 
30, 1, 400, 1208.49, 
30, 2, 400, 4973.34, 
30, 3, 400, 11116.9, 
30, 4, 400, 19671.7, 
30, 5, 400, 30524.3, 
40, 1, 400, 1601.79, 
40, 2, 400, 6733.5, 
40, 3, 400, 14954.3, 
40, 4, 400, 26099.9, 
40, 5, 400, 40995.7, 
50, 1, 400, 2019.53, 
50, 2, 400, 8509.52, 
50, 3, 400, 18890.8, 
50, 4, 400, 33051.3, 
50, 5, 400, 50735.2, 
60, 1, 400, 2410.68, 
60, 2, 400, 10325.7, 
60, 3, 400, 22634.8, 
60, 4, 400, 39798, 
60, 5, 400, 61756.3, 
20, 1, 500, 1010.85, 
20, 2, 500, 4067.85, 
20, 3, 500, 9108, 
20, 4, 500, 16287.6, 
20, 5, 500, 24985.2, 
30, 1, 500, 1509.08, 
30, 2, 500, 6226.03, 
30, 3, 500, 13756.2, 
30, 4, 500, 24191.4, 
30, 5, 500, 37872.6, 
40, 1, 500, 1996.72, 
40, 2, 500, 8318.37, 
40, 3, 500, 18484.8, 
40, 4, 500, 32393.6, 
40, 5, 500, 50785.3, 
50, 1, 500, 2490.6, 
50, 2, 500, 10581.9, 
50, 3, 500, 23318.2, 
50, 4, 500, 40677.4, 
50, 5, 500, 63330, 
60, 1, 500, 3021.36, 
60, 2, 500, 12700.1, 
60, 3, 500, 28306, 
60, 4, 500, 49896.3, 
60, 5, 500, 77661.6
]

FloatArr = c_float * (h * w)
float_arr = FloatArr(*messurements)

float_ptr = cast(float_arr, POINTER(c_float))

c=CPUMatrix(w,h,float_ptr)

print("------\n",c,"\n--------")

print(culib.find_hypothesis(byref(c)))


